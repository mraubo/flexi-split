â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    FAZA 1: FUNDAMENT - UKOÅƒCZONA âœ…                           â•‘
â•‘                   Infrastruktura API i Query Management                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“… Data: 2025-11-05
ğŸ“Š Status: âœ… UKOÅƒCZONA I PRZETESTOWANA

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¦ ZAINSTALOWANE ZALEÅ»NOÅšCI:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  âœ… react-hook-form@7.66.0
  âœ… @hookform/resolvers@5.2.2
  âœ… @tanstack/react-query@5.90.6

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ STWORZONE PLIKI:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1ï¸âƒ£  src/lib/api/client.ts (123 linii)
   â€¢ Typowany HTTP client z RFC 7807 error handling
   â€¢ Wsparcie dla GET, POST, PUT, DELETE, PATCH
   â€¢ Automatyczne parsowanie i error handling

2ï¸âƒ£  src/lib/api/queryClient.ts (86 linii)
   â€¢ Konfiguracja TanStack Query
   â€¢ Singleton pattern
   â€¢ Sensowne domyÅ›lne ustawienia

3ï¸âƒ£  src/components/QueryClientProvider.tsx (23 linii)
   â€¢ React wrapper dla TanStack QueryClientProvider
   â€¢ Wsparcie dla Astro SSR

4ï¸âƒ£  src/lib/hooks/api/useSettlements.ts (152 linii)
   â€¢ Custom hooks dla settlements CRUD
   â€¢ Automatyczna cache invalidation
   â€¢ Query key management

5ï¸âƒ£  src/lib/hooks/api/useParticipants.ts (95 linii)
   â€¢ Custom hooks dla participants CRUD
   â€¢ Cascade invalidation
   â€¢ Query key management

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœï¸  ZMODYFIKOWANE PLIKI:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  ğŸ“„ src/layouts/Layout.astro
     â€¢ Dodano QueryClientProvider z client:load

  ğŸ“„ src/layouts/AuthLayout.astro
     â€¢ Dodano QueryClientProvider z client:load

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“š DOKUMENTACJA:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  ğŸ“„ .docs/refactoring/00-refactoring-plan.md
     â€¢ OgÃ³lny plan refaktoryzacji
     â€¢ Status wszystkich faz
     â€¢ Metryki sukcesu

  ğŸ“„ .docs/refactoring/01-phase-1-foundations.md
     â€¢ SzczegÃ³Å‚owa dokumentacja FAZY 1
     â€¢ PrzykÅ‚ady uÅ¼ycia
     â€¢ Potencjalne problemy i rozwiÄ…zania

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… SPRAWDZENIA:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  âœ… Project builds successfully
  âœ… All unit tests pass (37 tests)
  âœ… No TypeScript errors
  âœ… New hooks are properly typed
  âœ… QueryClient is singleton pattern

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸš€ GOTOWE ROZWIÄ„ZANIA:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Typowany API Client:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const settlements = await apiClient.get("/api/settlements");
  const newSettlement = await apiClient.post("/api/settlements", { title: "..." });

Custom Query Hooks:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const { data: settlements } = useSettlements({ page: 1, limit: 10 });
  const createMutation = useCreateSettlement();
  const participants = useParticipants(settlementId);

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ NASTÄ˜PNY KROK:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FAZA 2: Shared Utilities
  â€¢ Wydzielenie wspÃ³lnych validatorÃ³w
  â€¢ Tworzenie reuÅ¼ywalnych form components
  â€¢ Utility funkcje do formatowania

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š STATYSTYKI:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Stworzone linie kodu:    ~479 linii (bez dokumentacji)
  Nowych plikÃ³w:           5 (API + hooks + provider)
  Zmodyfikowanych plikÃ³w:  2 (layouts)
  Dokumentacji:            2 pliki (.md)
  Testy:                   âœ… Wszystkie przechodzÄ…

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”— ZALEÅ»NOÅšCI:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FAZA 1 âœ… DONE
  â†“
FAZA 2: Shared Utilities ğŸ”„ PENDING
  â†“
FAZA 3: Auth Forms ğŸ”„ PENDING
  â†“
FAZA 4: Participant Components ğŸ”„ PENDING
  â†“
FAZA 5: Expense Hook ğŸ”„ PENDING
  â†“
FAZA 6: Settlement Summary ğŸ”„ PENDING
  â†“
FAZA 7: Documentation & Tests ğŸ”„ PENDING

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš ï¸  WAÅ»NE NOTATKI:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  â€¢ QueryClientProvider wymaga client:load w Astro layoutach
  â€¢ ApiClient jest singletonem i powinien byÄ‡ reuÅ¼ywany
  â€¢ Wszystkie API calls powinny uÅ¼ywaÄ‡ nowych hook'Ã³w
  â€¢ Query invalidation jest automatyczna po mutacjach

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ‘¥ INSTRUKCJE DLA DEVELOPERÃ“W:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  1. Czytaj .docs/refactoring/01-phase-1-foundations.md
  2. Importuj hook'i z src/lib/hooks/api/
  3. UÅ¼ywaj apiClient dla manual requests
  4. Polegaj na automatycznej cache invalidation

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ¨ PODSUMOWANIE:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FAZA 1 jest kompletna i przetestowana. Projekt builduje siÄ™ bez bÅ‚Ä™dÃ³w i wszystkie
testy przechodzÄ…. Infrastruktura jest gotowa do integracji z formami w FAZIE 2.
